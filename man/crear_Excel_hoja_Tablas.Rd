% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/crear_Excel_hoja_Tablas.R
\name{crear_Excel_hoja_Tablas}
\alias{crear_Excel_hoja_Tablas}
\title{Crea una hoja de Excel con múltiples tablas formateadas}
\usage{
crear_Excel_hoja_Tablas(
  tablas,
  titulo_principal = NULL,
  fila_titulo_principal = 1,
  titulos_tablas = NULL,
  nombre_hoja = NULL,
  hoja = 1,
  hay_var_grupo = NULL,
  formatear_tabla = FALSE,
  estilo_tabla = "TableStyleLight1",
  fuente = "Calibri",
  titulo_principal_tamanyo = 14,
  titulo_principal_colorFuente = "#00b2a9",
  titulo_tabla_colorFuente = "#00b2a9",
  titulo_tabla_tamanyo = 12,
  tabla_conFiltro = TRUE,
  nombre_archivo = NULL,
  exportar = FALSE,
  sobreescribir_archivo = TRUE,
  workbook = NULL,
  filas_tablas_asignadas = NULL
)
}
\arguments{
\item{tablas}{Lista de data.frames o tibbles. Cada elemento de la lista se escribirá como una tabla en la hoja.}

\item{titulo_principal}{Carácter. Título principal que se escribirá en la parte superior de la hoja. Si es \code{NULL}, se asigna un título por defecto basado en el valor de \code{hoja}.}

\item{titulos_tablas}{Vector de caracteres. Títulos para cada tabla. Si es \code{NULL}, se asignan títulos por defecto.}

\item{nombre_hoja}{Carácter. Nombre de la hoja. Si es \code{NULL}, se asigna un nombre basado en el valor de \code{hoja}.}

\item{hoja}{Número o nombre de la hoja en la que se escribirá la información. Por defecto es 1.}

\item{hay_var_grupo}{Lógico. Indica si se utilizó una variable de agrupación para generar las tablas.}

\item{formatear_tabla}{Lógico. Si es \code{TRUE}, se formatea cada tabla (por ejemplo, redondeo de valores y conversión a porcentajes) antes de escribirla. Por defecto es \code{TRUE}.}

\item{estilo_tabla}{Carácter. Estilo de tabla de Excel a aplicar. Por defecto es \code{"TableStyleLight1"}.}

\item{fuente}{Carácter. Nombre de la fuente a utilizar para los textos. Por defecto es \code{"Calibri"}.}

\item{titulo_principal_tamanyo}{Número. Tamaño de fuente para el título principal. Por defecto es 14.}

\item{titulo_principal_colorFuente}{Carácter. Color (en hexadecimal) para el título principal. Por defecto es \code{"#00b2a9"}.}

\item{titulo_tabla_colorFuente}{Carácter. Color (en hexadecimal) para el título de cada tabla. Por defecto es \code{"#00b2a9"}.}

\item{titulo_tabla_tamanyo}{Número. Tamaño de fuente para el título de cada tabla. Por defecto es 12.}

\item{tabla_conFiltro}{Lógico. Si es \code{TRUE}, se aplicarán filtros a las tablas de Excel. Por defecto es \code{TRUE}.}

\item{nombre_archivo}{Carácter. Nombre del archivo Excel de salida (sin extensión). Si es \code{NULL}, se asigna "HojadeTablas_analisisDescriptivo_temp".}

\item{exportar}{Lógico. Si es \code{TRUE}, se guarda el workbook en un archivo Excel. Por defecto es \code{TRUE}.}

\item{sobreescribir_archivo}{Lógico. Si es \code{TRUE}, se sobrescribe el archivo de salida en caso de existir. Por defecto es \code{TRUE}.}

\item{workbook}{Objeto workbook de \code{openxlsx}. Si es \code{NULL}, se crea un nuevo workbook.}

\item{filas_tablas_asignadas}{Data.frame con la posición de cada tabla. Por defecto \code{NULL}, es de uso interno.}
}
\value{
Devuelve un objeto workbook de \code{openxlsx} con la hoja y las tablas agregadas.
}
\description{
Esta función escribe en una única hoja de un objeto workbook de Excel múltiples tablas formateadas.
Se escribe un título principal en la parte superior de la hoja y, para cada tabla de la lista, se calcula la posición de inicio (utilizando la función \code{asignar_filas_tablas}) para evitar solapamientos.
Cada tabla se escribe aplicando un título propio y, opcionalmente, se pueden aplicar filtros y estilos.
}
\details{
La función valida que \code{tablas} sea una lista y, en caso de que se proporcionen nombres para las tablas (a través de \code{names(tablas)}), se incorporan al título de cada tabla.
Se utiliza la función \code{asignar_filas_tablas} para calcular la posición de cada tabla en la hoja y se escribe un título principal en la parte superior.
Cada tabla se escribe utilizando la función \code{crear_Excel_tabla}.
}
\examples{
\dontrun{
  library(dplyr)
  temp <- mtcars \%>\%
   mutate(
   'cyl'=as.character(cyl),
   'carb'=factor(carb),
   'gear' = factor(gear),
   'grupo' = sample(c('A','B'),nrow(.),T),
   'w'=rlnorm(32)
   )
 temp_numericas <- generar_descriptivos_numericos(temp)
 crear_Excel_hoja_Tablas(temp_numericas, exportar = T)
}


}
