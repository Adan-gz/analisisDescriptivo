% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/crear_Excel.R
\name{crear_Excel}
\alias{crear_Excel}
\title{Crea un workbook de Excel con varias hojas, cada una conteniendo tablas formateadas}
\usage{
crear_Excel(
  list_list_tablas,
  unificar_misma_hoja = TRUE,
  titulos_principales = NULL,
  titulos_tablas = NULL,
  nombres_hojas = NULL,
  hay_var_grupo = NULL,
  formatear_tabla = TRUE,
  estilo_tabla = "TableStyleLight1",
  fuente = "Calibri",
  titulo_principal_tamanyo = 14,
  titulo_principal_colorFuente = "#00b2a9",
  titulo_tabla_colorFuente = "#00b2a9",
  titulo_tabla_tamanyo = 12,
  tabla_conFiltro = TRUE,
  nombre_archivo = NULL,
  exportar = FALSE,
  sobreescribir_archivo = TRUE,
  workbook = NULL
)
}
\arguments{
\item{list_list_tablas}{Lista de listas. Cada elemento de esta lista debe ser, a su vez, una lista de data.frames o tibbles
que se escribirán en una hoja separada. Si algún elemento es un data.frame, se convertirá en una lista para asegurar la consistencia. Si únicamente
se quiere exportar una tabla (1 data.frame), utilizar \code{crear_Excel_tabla}.}

\item{unificar_misma_hoja}{Unificar listas en 1 misma hoja. Por ejemplo, que las tablas de descriptivos numéricos y categóricos, que por defecto
se recogen en 2 listas distintas, aparezcan en la misma hoja. Por defecto \(code){TRUE}.}

\item{titulos_principales}{Vector de caracteres. Títulos principales para cada hoja. Si es \code{NULL}, se asignan títulos por defecto.}

\item{titulos_tablas}{Lista o vector. Títulos para las tablas de cada hoja. Cada elemento de \code{titulos_tablas} se corresponde
con el conjunto de tablas de la hoja respectiva.}

\item{nombres_hojas}{Vector de caracteres. Nombres de las hojas. Si es \code{NULL}, se asignan nombres por defecto (por ejemplo, "Hoja 1", "Hoja 2", ...).}

\item{hay_var_grupo}{Lógico. Indica si se utilizó una variable de agrupación en la generación de las tablas. Este parámetro se pasa a las funciones de formateo. No utilizar salvo Error.}

\item{formatear_tabla}{Lógico. Si es \code{TRUE}, se formatearán los datos (por ejemplo, redondeo, formato de porcentajes)
antes de escribirlos en Excel. Por defecto es \code{TRUE}. Si las tablas que se introducen no provienen de las funciones \code{generar_descriptivos_*} pasarlo a \code{FALSE}.}

\item{estilo_tabla}{Carácter. Estilo de la tabla en Excel. Por defecto es \code{"TableStyleLight1"}.}

\item{fuente}{Carácter. Nombre de la fuente a utilizar en los textos. Por defecto es \code{"Calibri"}.}

\item{titulo_principal_tamanyo}{Número. Tamaño de fuente para el título principal. Por defecto es 14.}

\item{titulo_principal_colorFuente}{Carácter. Color (en hexadecimal) para el título principal. Por defecto es \code{"#00b2a9"}.}

\item{titulo_tabla_colorFuente}{Carácter. Color (en hexadecimal) para el título de cada tabla. Por defecto es \code{"#00b2a9"}.}

\item{titulo_tabla_tamanyo}{Número. Tamaño de fuente para el título de cada tabla. Por defecto es 12.}

\item{tabla_conFiltro}{Lógico. Si es \code{TRUE}, se aplicarán filtros a las tablas en Excel. Por defecto es \code{TRUE}.}

\item{nombre_archivo}{Carácter. Nombre del archivo Excel de salida (sin extensión). Si es \code{NULL}, se asigna un nombre por defecto.}

\item{exportar}{Lógico. Si es \code{TRUE}, se guarda el workbook en un archivo Excel. Por defecto es \code{TRUE}.}

\item{sobreescribir_archivo}{Lógico. Si es \code{TRUE}, se sobrescribe el archivo existente. Por defecto es \code{TRUE}.}

\item{workbook}{Objeto workbook de \code{openxlsx}. Si es \code{NULL}, se crea un nuevo workbook.}

\item{hoja}{Número. Valor por defecto para referenciar la primera hoja. No afecta el nombre de las hojas creadas.}
}
\value{
Devuelve un objeto workbook de \code{openxlsx} con todas las hojas y tablas agregadas. Exporta un archivo Excel.
}
\description{
Esta función genera un archivo Excel en el que cada hoja contiene un conjunto de tablas formateadas.
Cada elemento de la lista principal (\code{list_list_tablas}) corresponde a una hoja distinta.
Dentro de cada hoja se escribe un título principal y se exporta cada tabla (data.frame o tibble)
usando la función \code{crear_Excel_hoja_Tablas}. Además, se ajusta el formato (por ejemplo, fuente, colores, estilos)
y se puede optar por exportar el workbook a un archivo Excel.
}
\details{
La función revisa cada elemento de \code{list_list_tablas} para asegurar que sea una lista de tablas.
Para cada hoja se crea un nuevo worksheet con el nombre especificado en \code{nombres_hojas} y se escribe un título principal,
seguido de las tablas formateadas (usando \code{crear_Excel_hoja_Tablas}). Si \code{exportar} es \code{TRUE}, se guarda el workbook en un archivo Excel.
}
\examples{
\dontrun{
  library(dplyr)
  temp <- mtcars \%>\%
   mutate(
   'cyl'=as.character(cyl),
   'carb'=factor(carb),
   'gear' = factor(gear),
   'grupo' = sample(c('A','B'),nrow(.),T),
   'w'=rlnorm(32))
 temp_agruados_num1 <-  generar_descriptivos_agrupados(temp, vars_grupo = 'grupo', return_df = T)
 crear_Excel(temp_agruados_num1, exportar = T)

 ## Es posible generar los univariados y luego los agrupados:
 library(dplyr)
 temp <- mtcars \%>\%
   mutate('cyl'=as.character(cyl),
          'carb'=factor(carb),
          'gear' = factor(gear),
          'grupo' = sample(c('A','B'),nrow(.),T),
          'w'=rlnorm(32))

 desc_univariados <- generar_descriptivos_univariados(temp)
 desc_agrupados <- generar_descriptivos_agrupados(temp, vars_grupo = 'grupo', var_peso = 'w')

 workbook <- crear_Excel(
   desc_univariados,
   nombres_hojas = 'UNIVARIADOS',
   unificar_misma_hoja = T,
   exportar = F
 )

 workbook <- crear_Excel(
   desc_agrupados,
   workbook = workbook,
   nombres_hojas = 'AGRUPADO',
   unificar_misma_hoja = T,
   exportar = T
 )#'
}

}
